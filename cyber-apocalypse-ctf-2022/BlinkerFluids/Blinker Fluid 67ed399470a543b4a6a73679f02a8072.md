# Blinker Fluid

Author: Jun Peng Tan
Event : Cyber Apocalypse 2022
Tags: Web

# Challenge Description

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled.png)

## Challenge Walkthrough

In this challenge, we’re given a bunch of files related to the website and the link is provided. Going through the link given, the website let us to generate the new pdf invoice. 

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%201.png)

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%202.png)

Inside the website, there is a pdf inside. We can take a look with the path /static/invoices/[filename].pdf

This doesn’t any info to us to solve this challenge. 

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%203.png)

Let’s take deep look over the files given. In the package.json file, we can find the version of the plugins within the website and notice that there is “md-to-pdf: 4.1.0” plugin. 

After Google “md-to-pdf”, it is one of the vulnerable plugin reported which is CVE-2021-23639. You can check more about this CVE details over the link. 

[https://nvd.nist.gov/vuln/detail/CVE-2021-23639](https://nvd.nist.gov/vuln/detail/CVE-2021-23639)

[https://security.snyk.io/vuln/SNYK-JS-MDTOPDF-1657880](https://security.snyk.io/vuln/SNYK-JS-MDTOPDF-1657880)

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%204.png)

Based on the CVE details, this vulnerable plugin version is before 5.0.0. Therefore, we can perform a exploit into it as the website version provided is 4.1.0. 

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%205.png)

You can find for the md-to-pdf payload in this issues which people have posted h[ttps://github.com/simonhaenisch/md-to-pdf/issues/99](https://github.com/simonhaenisch/md-to-pdf/issues/99) that can be injected into the website. 

This payload, we can retrieve the id which store at the server and you can store it at the specific path. 

```jsx
# payload
---js
((require("child_process")).execSync("id > /app/static/RCE.txt"))
---
```

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%206.png)

Then, go to the path that we’ve uploaded the txt file and we get the response with the data. 

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%207.png)

Thus, lets modify the payload to retrieved the flag from the server. 

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%208.png)

## Flag

Then finally you will get the flag !

![Untitled](Blinker%20Fluid%2067ed399470a543b4a6a73679f02a8072/Untitled%209.png)